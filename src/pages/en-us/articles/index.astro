---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import Header from '../../../components/Header.astro';
import Footer from '../../../components/Footer.astro';
import ArticleCard from '../../../components/ArticleCard.astro';
import { getCollection } from 'astro:content';

// Get all EN-US articles, sorted by date
const allArticles = await getCollection('articles', ({ id, data }) => id.startsWith('en-us/') && !data.draft);
const sortedArticles = allArticles.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const title = "All Articles";
const description = "Browse all articles covering gadgets, lifestyle, and news.";
---

<BaseLayout title={`BLITZ - ${title}`} description={description} lang="en-us">
  <Header />
  
  <main class="articles-index">
    <section class="page-header">
      <div class="container">
        <h1 class="page-title">{title}</h1>
        <p class="page-description">{description}</p>
      </div>
    </section>
    
    <section class="article-grid-section">
      <div class="container">
        <div class="article-grid">
          {sortedArticles.map((article, index) => (
            <ArticleCard 
              title={article.data.title}
              description={article.data.description}
              href={`/en-us/articles/${article.slug.replace('en-us/', '')}`}
              genre={article.data.genre}
              date={article.data.date}
              image={article.data.image}
              delay={index * 0.05} 
            />
          ))}
        </div>
      </div>
    </section>
  </main>
  
  <Footer />
</BaseLayout>

<style>
  .articles-index {
    min-height: 100vh;
    padding-top: var(--spacing-20);
  }
  
  .page-header {
    padding: var(--spacing-12) 0;
    text-align: center;
  }
  
  .page-title {
    font-size: var(--font-size-4xl);
    margin-bottom: var(--spacing-4);
  }
  
  .page-description {
    color: var(--color-text-secondary);
    font-size: var(--font-size-lg);
    max-width: 600px;
    margin: 0 auto;
  }
  
  .article-grid-section {
    padding-bottom: var(--spacing-24);
  }
  
  .article-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--spacing-8);
  }
  
  @media (max-width: 768px) {
    .article-grid {
      grid-template-columns: 1fr;
      gap: var(--spacing-6);
    }
  }
</style>
